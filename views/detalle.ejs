<%- include("template/cabezera",{titulo: "Detalles de Mascotas"}) %>
<body>
  <%- include("template/navbar") %>
  <div class="container">
    <h1>Detalle Mascotas</h1>
    <% if(error) {%>
    <p><%= mensaje %></p>
    <a href="/mascotas" class="btn btn-dark w-100">Volver a Mascotas</a>
    <% } %> <% if(!error) {%>
    <table class="table">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Nombre</th>
          <th scope="col">Descripcion</th>
          <th scope="col">Accion</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row"><%= mascota.id %></th>
          <td><%= mascota.nombre %></td>
          <td><%= mascota.descripcion %></td>
          <td>
            <button
              class="btn btn-danger btn-sm"
              id="btnEliminar"
              data-id="<%= mascota.id %>"
            >
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <% } %>
  </div>

  <%- include("template/footer") %>
</body>

<script>
  const idEliminar = document.querySelector("#btnEliminar");
  idEliminar.addEventListener("click", async () => {
    const id = idEliminar.dataset.id;
    console.log(id, "soy el id");

    try {
      const data = await fetch(`/mascotas/${id}`, {
        method: "delete",
      });
      const res = await data.json();
      console.log(res, "soy el console");
      if (res.estado) {
        alert("Se elimino correctamente la mascota");
        window.location.href = "/mascotas";
      } else {
        console.log(res);
      }
    } catch (error) {
      console.log(error);
    }
  });
</script>
